We start by proving two lemmas which shows a property of DG-modules which makes it possible to compare Toda brackets and Massey products.

The first lemma shows an interesting consequence of the definition of shift and differential in \( \C_{\dg} \), that is useful in proving the second lemma.

WIP START

% TODO: Endr notasjon.
\begin{notation}
    Let \( n \in \Zb \), and \( A \) a chain complex.
    
    Then let \( A_{\bullet+n} \) denote the \( n \)-shifted chain complex of \( A \) but \emph{without} the \( (-1)^n \) sign in front of the differential.
\end{notation}

\begin{lemma}
    \label{lem:shift_one_component_inner_product_chain_complex}
    Let \( A, B \in \C \).

    Then there is a canonical isomorphism
    \[
        \class{\Sigma^{-n} A, B} \cong \class{A, B}_{\bullet+n}.
    \]

    I.e.,
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                \class{\Sigma^{-n} A, B}: \&[-0.9cm] \cdots \& \class{\Sigma^{-n} A, B}_{-1} \& \class{\Sigma^{-n} A, B}_0 \& \class{\Sigma^{-n} A, B}_1 \& \cdots \\
                \class{A, B}_{+n}: \& \cdots \& \class{A, B}_{n - 1} \& \class{A, B}_n \& \class{A, B}_{n + 1} \& \cdots \\
            };

            \draw[math]
                (m-1-1) edge[equality] (m-2-1)
                (m-1-2) edge (m-1-3)
                (m-1-3) edge node {d_{-1}} (m-1-4)
                    edge[equality] (m-2-3)
                (m-1-4) edge node {d_0} (m-1-5)
                    edge[equality] (m-2-4)
                (m-1-5) edge (m-1-6)
                    edge[equality] (m-2-5)

                (m-2-2) edge (m-2-3)
                (m-2-3) edge node {d_{n-1}} (m-2-4)
                (m-2-4) edge node {d_n} (m-2-5)
                (m-2-5) edge (m-2-6);
        \end{tikzpicture}
    \end{center}
\end{lemma}
\begin{proof}
    For any \( i \in \Zb \), there are two parts that need to be proved.

    First, we need to show that \( \class{\Sigma^{-n} A, B}_i = \class{A, B}_{n + i} \), and second, need to show that \( d_{\class{\Sigma^{-n} A, B}, i} = d_{\class{A, B}, n + i} \).

    We start with the first part.

    Expanding the definitions, we get that
    \begin{align*}
        \class{\Sigma^{-n} A, B}_i &= \prod_{j \in \Zb} \Mod(R)((\Sigma^{-n} A)_j, B_{j + i}) \\
        &= \prod_{j \in \Zb} \Mod(R)(A_{j - n}, B_{j + i}) \\
        &= \prod_{j \in \Zb} \Mod(R)(A_j, B_{j + i + n}) \\
        &= [A, B]_{i + n}
    \end{align*}

    And for the second part, let \( \tuple{f_j}_{j \in \Zb} \in [A, B]_{n + i} \) and consider the following equation
    \begin{align*}
        d_{\class{\Sigma^{-n} A, B}, i}\tuple{f_j}_{j \in \Zb} &= \tuple*{d_{B, n + i + j} \circ f_j - (-1)^i f_{j + 1} \circ d_{\Sigma^{-n} A, j + n}}_{j \in \Zb} \\
        &= \tuple*{d_{B, n + i + j} \circ f_j - (-1)^{n + i} f_{j + 1} \circ d_{A, j}}_{j \in \Zb} \\
        &= d_{\class{A, B}, n + i}(f_j)_{j \in \Zb}
    \end{align*}
\end{proof}

% TODO: J--M trur eg får shift på andra leddet.
\begin{lemma}
    \label{lem:dgmod_shift_eq_plus}
    Let \( F, G \in \dgM \).

    Then there is a canonical isomorphism
    \[
        \dgM(\Sigma^{-i} F, G) \cong \dgM(F, G)_{\bullet + i}.
    \]
\end{lemma}
\begin{proof}
    By \autoref{lem:shift_one_component_inner_product_chain_complex},
    \[
        \prod_{A \in \Cc^{\op}} \C_{\dg}(\Sigma^{-i} F A, G A) = \prod_{A \in \Cc^{\op}} \C_{\dg}(F A, G A)_{+i} = \tuple*{\prod_{A \in \Cc^{\op}} \C_{\dg}(F A, G A)}_{+i}.
    \]
    It remains to show that for any \( n \in \Zb \),
    \[
        \eta \in \tuple*{\prod_{A \in \Cc^{\op}} \C_{\dg}(\Sigma^{-i} F A, G A)}_n
    \]
    satisfies the properties of \( \dgM(\Sigma^{-i} F, G)_n \) if and only if it satisfies the properties of \( \dgM(F, G)_{n + i} \).

    This follows because for any \( f \in \Cc^{\op}(A', A'') \) we have the following equality
    \[
        (-1)^{nj} \eta_{A''} \circ (\Sigma^{-i} F f) = (-1)^{nj} \eta_{A''} \circ ((-1)^{ji}F f) = (-1)^{(n + i)j}\eta_{A''} \circ (F f),
    \]
    and therefore
    \[
        (G f) \circ \eta_{A'} = (-1)^{nj} \eta_{A''} \circ (\Sigma^{-i} F f) = (-1)^{(n + i)j}\eta_{A''} \circ (F f).
    \]
\end{proof}

% Ikkje sant, trur eg.
% \begin{lemma}
%     \label{lem:shift_one_component_inner_product_chain_complex}
%     For any \( n \in \Zb \), and for any chain complex \( K \), let \( K_{+n} \) denote the \( n \)-shifted chain complex of \( K \) but \emph{without} the \( (-1)^n \) sign in front of the differential.

%     Then
%     \[
%         \class{\Sigma^{-n} A, B} = \class{A, B}_{+n} = \class{A, B_{+n}}.
%     \]
%     I.e.
%     \begin{center}
%         \begin{tikzpicture}
%             \diagram{m}{1cm}{1cm} {
%                 \class{\Sigma^{-n} A, B}: \&[-0.9cm] \cdots \& \class{\Sigma^{-n} A, B}_{-1} \& \class{\Sigma^{-n} A, B}_0 \& \class{\Sigma^{-n} A, B}_1 \& \cdots \\
%                 \class{A, B}_{+n}: \& \cdots \& \class{A, B}_{n - 1} \& \class{A, B}_n \& \class{A, B}_{n + 1} \& \cdots \\
%                 \class{A, B_{+n}}: \& \cdots \& \class{A, B_{+n}}_{-1} \& \class{A, B_{+n}}_0 \& \class{A, B_{+n}}_1 \& \cdots \\
%             };

%             \draw[math]
%                 (m-1-1) edge[equality] (m-2-1)
%                 (m-1-2) edge (m-1-3)
%                 (m-1-3) edge node {d_{-1}} (m-1-4)
%                     edge[equality] (m-2-3)
%                 (m-1-4) edge node {d_0} (m-1-5)
%                     edge[equality] (m-2-4)
%                 (m-1-5) edge (m-1-6)
%                     edge[equality] (m-2-5)

%                 (m-2-1) edge[equality] (m-3-1)
%                 (m-2-2) edge (m-2-3)
%                 (m-2-3) edge node {d_{n-1}} (m-2-4)
%                     edge[equality] (m-3-3)
%                 (m-2-4) edge node {d_n} (m-2-5)
%                     edge[equality] (m-3-4)
%                 (m-2-5) edge (m-2-6)
%                     edge[equality] (m-3-5)

%                 (m-3-2) edge (m-3-3)
%                 (m-3-3) edge node {d_{-1}} (m-3-4)
%                 (m-3-4) edge node {d_0} (m-3-5)
%                 (m-3-5) edge (m-3-6);
%         \end{tikzpicture}
%     \end{center}
% \end{lemma}
% \begin{proof}
%     For any \( i \in \Zb \), there are two parts that need to be proved.

%     First, we need to show that
%     \[
%         \class{\Sigma^{-n} A, B}_i = \class{A, B}_{n + i} = \class{A, B_{+n}}_i,
%     \]
%     and second, need to show that
%     \[
%         d_{\class{\Sigma^{-n} A, B}, i} = d_{\class{A, B}, n + i} = d_{\class{A, B_{+n}}, i}.
%     \]

%     We start with the first part.

%     Expanding the definitions, we get that
%     \begin{align*}
%         \class{\Sigma^{-n} A, B}_i &= \prod_{j \in \Zb} \Mod(R)((\Sigma^{-n} A)_j, B_{j + i}) \\
%         &= \prod_{j \in \Zb} \Mod(R)(A_{j - n}, B_{j + i}) \\
%         &= \prod_{j \in \Zb} \Mod(R)(A_j, B_{j + i + n}) = [A, B]_{i + n} \\
%         &= \prod_{j \in \Zb} \Mod(R)(A_j, (B_{+n})_{j + i}) = \class{A, B_{+n}}_i
%     \end{align*}

%     And for the second part, let \( \tuple{f_j}_{j \in \Zb} \in [A, B]_{n + i} \) and consider the following two equations
%     \begin{align*}
%         (d_{\class{\Sigma^{-n} A, B}, i} - d_{\class{A, B}, n + i})\tuple{f_j}_{j \in \Zb} &= \big(d_{B, n + i + j} \circ f_j - (-1)^i f_{j + 1} \circ d_{\Sigma^{-n} A, j + n} \\
%         &\hspace{0.4cm} - d_{B, n + i + j} \circ f_j + (-1)^{n + i} f_{j + 1} \circ d_{A, j}\big)_j \\
%         &= \tuple{(-1)^{n + i} f_{j + 1} \circ d_{A, j} - (-1)^i f_{j + 1} \circ d_{\Sigma^{-n} A, j + n}}_j \\
%         &= \tuple{(-1)^{n + i} f_{j + 1} \circ d_{A, j} - (-1)^{n + i} f_{j + 1} \circ d_{A, j}}_j \\
%         &= 0,
%     \end{align*}
%     and
%     \begin{align*}
%         (d_{\class{A, B}, n + i} - d_{\class{A, B_{+n}}, i})\tuple{f_j}_{j \in \Zb} &= \tuple{d_{B, n + i + j} \circ f_j - (-1)^{n + i} f_{j + 1} \circ d_{A, j} - d_{B_{+n}, i + j} \circ f_j + (-1)^i f_{j + 1} \circ d_{A, j}}
%     \end{align*}
% \end{proof}
The following corollary from \autoref{lem:dgmod_shift_eq_plus}, is essential in the definition of Massey products on \( H^0(\dgM) \) and therefore any algebraic triangulated category, which will become apparent later.

\begin{corollary}
    \label{cor:H^i_dgmod_cong_H^0_with_shift}
    Let \( F, G \in \dgM \).

    Then there is a canonical isomorphism
    \[
        H^i(\dgM(F, G)) \cong H^0(\dgM)(\Sigma^{-i} F, G).
    \]
\end{corollary}
\begin{proof}
    Take \( H^0 \) on both sides of \autoref{lem:dgmod_shift_eq_plus}.
\end{proof}

Using the above corollary, we can define how to take the Massey product in \( H^0(\dgM) \).

\begin{definition}[Massey product on \( H^0(\dgM) \)]
    \label{def:massey_product_H^0(dgMod_dg(C))}
    Let \( \Cc \) be a DG-category.
    
    Let the following be a diagram in \( H^0(\dgM) \)
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                X_0 \& X_1 \& X_2 \& X_3. \\
            };

            \draw[math]
                (m-1-1) edge node {f_1} (m-1-2)
                (m-1-2) edge node {f_2} (m-1-3)
                (m-1-3) edge node {f_3} (m-1-4);
        \end{tikzpicture}
    \end{center}
    Considering this as a DG-diagram in \( H^{\bullet}(\dgM) \), with \( |f_i| = 0 \), and the equality from \autoref{cor:H^i_dgmod_cong_H^0_with_shift}, let the following
    \[
        \massey{f_3, f_2, f_1} \subseteq H^0(\dgM)(\Sigma A, B)
    \]
    be called the \emph{Massey product of \( f_1, f_2, f_3 \) in \( H^0(\dgM) \)}.
\end{definition}

Using the above definition, we can define the Massey product more generally in an algebraic triangulated category.

\begin{definition}[Massey product in an algebraic triangulated category]
    \label{def:massey_product_alg_tri_cat}
    Let \( \Tc \) be an algebraic triangulated category, let \( \Cc \) be the DG-enhancement of \( \Tc \) with \( \Phi: \Tc \to H^0(\Cc) \) the equivalence by the algebraic triangulated category property.
    
    Let the following be a diagram in \( \Tc \)
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                X_0 \& X_1 \& X_2 \& X_3. \\
            };

            \draw[math]
                (m-1-1) edge node {f_1} (m-1-2)
                (m-1-2) edge node {f_2} (m-1-3)
                (m-1-3) edge node {f_3} (m-1-4);
        \end{tikzpicture}
    \end{center}
    Consider the following diagram in \( H^0(\Cc) \)
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                \Phi X_0 \& \Phi X_1 \& \Phi X_2 \& \Phi X_3. \\
            };

            \draw[math]
                (m-1-1) edge node {\Phi f_1} (m-1-2)
                (m-1-2) edge node {\Phi f_2} (m-1-3)
                (m-1-3) edge node {\Phi f_3} (m-1-4);
        \end{tikzpicture}
    \end{center}
    Consider again the following diagram in \( H^0(\dgM) \)
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                H^0(\mathbf{h}) \Phi X_0 \& H^0(\mathbf{h}) \Phi X_1 \& H^0(\mathbf{h}) \Phi X_2 \& H^0(\mathbf{h}) \Phi X_3. \\
            };

            \draw[math]
                (m-1-1) edge node {H^0(\mathbf{h}) \Phi f_1} (m-1-2)
                (m-1-2) edge node {H^0(\mathbf{h}) \Phi f_2} (m-1-3)
                (m-1-3) edge node {H^0(\mathbf{h}) \Phi f_3} (m-1-4);
        \end{tikzpicture}
    \end{center}
    Take the Massey product of the above diagram in \( H^0(\dgM) \) to get
    \[
        \massey{H^0(\mathbf{h}) \Phi f_3, H^0(\mathbf{h}) \Phi f_2, H^0(\mathbf{h}) \Phi f_1} \subseteq H^0(\dgM)(\Sigma H^0(\mathbf{h}) \Phi X_0, H^0(\mathbf{h}) \Phi X_3)
    \]
    Then apply \( \Phi^{-1} H^0(\mathbf{h})^{-1} \) to the result to get
    \[
        \Phi^{-1} H^0(\mathbf{h})^{-1} \massey{H^0(\mathbf{h}) \Phi f_3, H^0(\mathbf{h}) \Phi f_2, H^0(\mathbf{h}) \Phi f_1},
    \]
    which, up to pre and post-composition with the natural isomorphisms \( \Phi^{-1} H^0(\mathbf{h})^{-1} H^0(\mathbf{h}) \Phi \to \Id_{\Tc} \), is a subset of \( \Tc(\Sigma X_0, X_3) \).

    This subset of \( \Tc(\Sigma X_0, X_3) \) is called the \emph{massey product of \( f_1, f_2 \) and \( f_3 \) in an algebraic triangulated category}.
\end{definition}
