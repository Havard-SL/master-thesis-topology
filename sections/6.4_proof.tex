We start by proving some lemmas and giving some definitions that are required for the proof.

The following lemma connects Toda brackets and Massey products in \( H^0(\dgM) \) and is the reason we can compare Toda brackets and Massey products in algebraic triangulated categories.

\begin{lemma}
    Let \( \Cc \) be a small DG-category, and let the following be a diagram in \( H^0(\dgM) \),
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                X_1 \& X_2 \& X_3 \& X_4. \\
            };

            \draw[math]
                (m-1-1) edge node {f_1} (m-1-2)
                (m-1-2) edge node {f_2} (m-1-3)
                (m-1-3) edge node {f_3} (m-1-4);
        \end{tikzpicture}
    \end{center}
    Then
    \[
        \toda{f_3, f_2, f_1} = -\massey{f_3, f_2, f_1}.
    \]
\end{lemma}
% TODO: Det er noko sus med beviset. Anten er trianguleringa til dgM feil, eller s책 er forteiknet p책 Massey=Toda feil.
\begin{proof}
    We will prove this by showing the two inclusions \( \supseteq \) and \( \subseteq \).

    Start by showing \( \supseteq \).

    Let \( f \in \massey{f_3, f_2, f_1} \). Then by definition of massey product there exists
    \[
        g_i \in \dgM(X_i, X_{i + 1})_0
    \]
    with \( [g_i] = f_i \) for \( i = 1, 2, 3 \), as well as
    \[
        s \in \dgM(X_2, X_4)_{-1}
    \]
    and
    \[
        t \in \dgM(X_1, X_3)_{-1}
    \]
    with \( d(s) = - g_3 \circ g_2 \) and \( d(t) = - g_2 \circ g_1 \) such that
    \[
        f = \class{s \circ g_1 - g_3 \circ t}.
    \]

    % WIP: Kvifor kan eg laga matrise av dgmod morfiar og f책 ein dgmod morfi?
    %   Kvifor kan alpha g책 inn i cone?
    By \autoref{lem:dgmod_shift_eq_plus}, consider \( t \) as an element of \( \dgM(\Sigma X_1, X_3)_0 \). Consider \( \Sigma^{-1} t = t \). Then we can construct the following morphism.
    \[
        \alpha =
        \begin{pmatrix}
            g_1 \\
            t
        \end{pmatrix}
        \in \dgM(X_1, X_2 \oplus \Sigma^{-1} X_3)_0.
    \]
    By \autoref{rem:dgm_different_dg_morphisms_same_space_give_degree-wise_same_morphisms}, we can consider \( \alpha \) as an element of \( \dgM(X_1, \Sigma^{-1} C_{g_2})_0 \).

    Similarly, consider \( s \) as an element of \( \dgM(\Sigma X_2, X_4)_0 \).

    Then define
    \[
        \beta =
        \begin{pmatrix}
            s & -g_3
        \end{pmatrix}
        : (\Sigma X_2) \oplus X_3 \to X_4,
    \]
    which also by \autoref{rem:dgm_different_dg_morphisms_same_space_give_degree-wise_same_morphisms} can be considered as a morphism in \( \dgM(C_{g_2}, X_4)_0 \).

    Then we want to show that \( \alpha \) and \( \beta \) are cocyles:

    Consider the following two equations
    \begin{align*}
        d_{\dgM(X_1, \Sigma^{-1} C_{g_2})}(\alpha)
        &= d_{\Sigma^{-1} C_{g_2}} \circ \alpha - \alpha \circ d_{X_1} \\
        &= -
        \begin{pmatrix}
            - d_{X_2} & 0 \\
            g_2 & d_{X_3}
        \end{pmatrix}
        \circ
        \begin{pmatrix}
            g_1 \\
            t
        \end{pmatrix}
        -
        \begin{pmatrix}
            g_1 \\
            t
        \end{pmatrix}
        \circ
        d_{X_1} \\
        &=
        \begin{pmatrix}
            d_{X_2} \circ g_1 - g_1 \circ d_{X_1} \\
            - g_2 \circ g_1 - d_{X_3} \circ t - t \circ d_{X_1}
        \end{pmatrix} \\
        &=
        \begin{pmatrix}
            d_{\dgM(X_1, X_2)}(g_1) \\
            \bar{g_2} \circ g_1 - d_{\dgM(X_1, X_3)}(t)
        \end{pmatrix}
        =
        0,
    \end{align*}
    and,
    \begin{align*}
        d_{\dgM(C_{g_2}, X_4)}(\beta)
        &= d_{X_4} \circ \beta - \beta \circ d_{C_{g_2}} \\
        &= d_{X_4} \circ
        \begin{pmatrix}
            s & -g_3
        \end{pmatrix}
        -
        \begin{pmatrix}
            s & -g_3
        \end{pmatrix}
        \circ
        \begin{pmatrix}
            - d_{X_2} & 0 \\
            g_2 & d_{X_3}
        \end{pmatrix} \\
        &=
        \begin{pmatrix}
            d_{X_4} \circ s + s \circ d_{X_2} + g_3 \circ g_2 & - d_{X_4} \circ g_3 + g_3 \circ d_{X_3}
        \end{pmatrix} \\
        &=
        \begin{pmatrix}
            d_{\dgM(X_2, X_4)}(s) - \bar{g_3} \circ g_2 & -d_{\dgM(X_3, X_4)}(g_3)
        \end{pmatrix}
        = 0.
    \end{align*}
    
    Then we want to show that \( -\alpha \) and \( -\beta \) fit into the fiber-cofiber definition of Toda brackets.

    Since \( \Sigma_{H^0(\dgM)} \) and is an automorphism by \autoref{rem:dgm_sigma_automorphism}, we can use a simplified version of the fiber-cofiber definition of Toda brackets without assuming a natural isomorphism from \( \Sigma \Sigma^{-1} \) to \( \Id \).

    We want the following diagram to commute, where the middle row is the right-rotated standard triangle of \( g_2 \),
    \begin{center}
        \begin{tikzpicture}
            \diagram{m}{1cm}{1cm} {
                X_1 \& X_2 \\
                \Sigma^{-1} C_{g_2} \& X_2 \& X_3 \& C_{g_2} \\
                \& \& X_3 \& X_4. \\
            };

            \draw[math]
                (m-1-1) edge node {[f_1]} (m-1-2)
                    edge node {[-\alpha]} (m-2-1)
                (m-1-2) edge[equality] (m-2-2)

                (m-2-1) edge node {[- \Sigma^{-1} \pi_{\Sigma X_2}]} (m-2-2)
                (m-2-2) edge node {[f_2]} (m-2-3)
                (m-2-3) edge node {[\iota]} (m-2-4)
                    edge[equality] (m-3-3)
                (m-2-4) edge node {[-\beta]} (m-3-4)

                (m-3-3) edge node {[f_3]} (m-3-4);
        \end{tikzpicture}
    \end{center}

    We show that the left square commutes,
    \begin{align*}
        \class*{- (\Sigma^{-1} \pi) \circ (- \alpha)} &= \class{\pi \circ \alpha} \\
        &=
        \class*{
            \begin{pmatrix}
                1 & 0
            \end{pmatrix}
            \circ
            \begin{pmatrix}
                g_1 \\
                t
            \end{pmatrix} 
        } \\
        &= \class*{g_1} = \class*{f_1}
    \end{align*}
    and that the right square commutes,
    \begin{align*}
        \class*{(- \beta) \circ \iota} &=
        \class*{
            \begin{pmatrix}
                - s & g_3
            \end{pmatrix}
            \circ
            \begin{pmatrix}
                0 \\
                1
            \end{pmatrix}
         } \\
        &= \class*{g_3} = \class*{f_3}.
    \end{align*}

    That means that: FEIL
    \[
        \class*{(-\beta) \circ (\Sigma (- \alpha))} = \class*{\beta \circ (\Sigma \alpha)} = \class*{\beta \circ \alpha} = f
    \]
    is in \( \toda{f_3, f_2, f_1} \).

    Then we want to show \( \subseteq \):

    % TODO: Kvifor kan me anta at Y = C_g_2?
    Let \( f \in \toda{f_3, f_2, f_1} \). Using the fiber-cofiber definition of Toda brackets, and assuming \( Y = C_{f_2} \), we get that there exist some \( \alpha \in \dgM(X_1, \Sigma^{-1} C_{f_2})_0 \) and \( \beta \in \dgM(C_{f_2}, X_4)_0 \), such that
    \[
        f = \beta \circ (\Sigma \alpha).
    \]

    We want to find \( g_1 \in \dgM(X_1, X_2)_0 \), \( g_2 \in \dgM(X_2, X_3)_0 \), \( g_3 \in \dgM(X_3, X_4)_0 \), \( s \in \dgM(X_2, X_4)_{-1} \), and \( t \in \dgM(X_1, X_3)_{-1} \) with \( d(t) = - g_2 \circ g_1 \) and \( d(s) = -g_3 \circ g_2 \), such that \( f = \class{s \circ g_1 - g_3 \circ t} \).

    Let \( g_1 := (-\Sigma^{-1} \pi_{\Sigma X_2}) \circ \alpha \), \( g_2 = f_2 \), and let \( g_3 := \beta \circ \iota_{X_3} \). 

    Furthermore, consider \( \iota_{\Sigma X_2} \in \dgM(\Sigma X_2, C_{f_2})_0 \) as an element of \( \dgM(X_2, C_{f_2})_{-1} \), and let \( s := \beta \circ \iota_{\Sigma X_2} \). In addition, consider \( \Sigma^{-1} \pi_{X_3} \in \dgM(\Sigma^{-1} C_{f_2}, \Sigma^{-1} X_3)_0 \) as an element of \( \dgM(\Sigma^{-1} C_{f_2}, X_3)_{-1} \), and let \( t := (\Sigma^{-1} \pi_{X_3}) \circ \alpha \).

    Then the above properties all hold by the following three equations:

    Remember the equations from \autoref{rem:dgm_differentials_of_inclusions_and_projections_of_cone}.

    First, \( d(s) = -g_3 \circ g_2 \): FEIL
    \begin{align*}
        d_{\dgM(X_2, X_4)}(s) &= d_{\dgM(X_2, X_4)}(\beta \circ \iota_{\Sigma X_2}) \\
        &= d_{\dgM(C_{f_2}, X_4)}(\beta) \circ \iota_{\Sigma X_2} + \beta \circ d_{\dgM(X_2, C_{f_2})}(\iota_{\Sigma X_2}) \\
        \intertext{by assumption, \( \beta \) is a cocycle}
        &= 0 \circ \iota_{\Sigma X_2} + \beta \circ \iota_{X_3} \circ f_2 \\
        &= \beta \circ \iota_{X_3} \circ f_2 \\
        &= g_3 \circ g_2.
    \end{align*}
    Second, \( d(t) = - g_2 \circ g_1 \):
    \begin{align*}
         d_{\dgM(X_1, X_3)}(t) &= d_{\dgM(X_1, X_3)}((\Sigma^{-1} \pi_{X_3}) \circ \alpha) \\
         &= d_{\dgM(\Sigma^{-1} C_{f_2}, X_3)}(\Sigma^{-1} \pi_{X_3}) \circ \alpha \\
         &= - d_{\dgM(\Sigma^{-1} C_{f_2}, X_3)}(\pi_{X_3}) \circ \alpha \\
         &= (\Sigma f_2) \circ \pi_{\Sigma X_3} \circ \alpha \\
         &= - f_2 \circ (- \Sigma^{-1} \pi_{\Sigma X_3}) \circ \alpha \\
         &= - g_2 \circ g_1.
    \end{align*}
    Third, \( -f = \class{s \circ g_1 - g_3 \circ t} \): TODO: Shift av morfiar forvirring. FEIL
    \begin{align*}
        s \circ g_1 - g_3 \circ t &= \beta \circ \iota_{\Sigma X_2} \circ (-\Sigma^{-1} \pi_{\Sigma X_2}) \circ \alpha - \beta \circ \iota_{X_3} \circ (\Sigma^{-1} \pi_{X_3}) \circ \alpha \\
        &= - \beta \circ \tuple*{\iota_{\Sigma X_2} \circ \pi_{\Sigma X_2} + \iota_{X_3} \circ \pi_{X_3}} \circ \alpha \\
        &= - \beta \circ \Id_{C_{f_2}} \circ \alpha \\
        &= - \beta \circ \alpha = - f.
    \end{align*}
\end{proof}

The following is the proof of \autoref{theorem:massey_equals_toda}.

\begin{proof}[Proof of Massey products = Toda brackets]
    
\end{proof}